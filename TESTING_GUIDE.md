# 채팅 기능 테스트 가이드

## 사전 준비

### 필수 환경 변수 확인

```bash
fly secrets list --app prompt-booster
```

다음 환경 변수가 설정되어 있어야 합니다:
- ✅ DATABASE_URL
- ✅ NEXTAUTH_SECRET
- ✅ NEXTAUTH_URL
- ✅ **GEMINI_API_KEY** (채팅 기능 테스트를 위해 필수)

## 테스트 항목

### 1. 채팅 질문/답변 플로우 테스트

**목적**: 사용자가 질문에 답변하고 다음 질문을 받는 전체 플로우 확인

**테스트 절차**:
1. https://prompt-booster.fly.dev 접속
2. 초기 질문 "무엇을 만들어보고 싶으신가요?" 확인
3. 답변 입력 (예: "온라인 쇼핑몰")
4. Enter 키 또는 전송 버튼 클릭
5. 다음 질문이 생성되는지 확인
6. 여러 질문에 답변하며 대화 진행
7. 완료 질문이 나오는지 확인

**예상 결과**:
- ✅ 각 답변 후 다음 질문이 즉시 생성됨
- ✅ 질문이 프로젝트 문서 작성에 필요한 정보를 수집함
- ✅ 로딩 상태가 적절히 표시됨
- ✅ 에러 발생 시 사용자 친화적 메시지 표시

**확인 사항**:
- [ ] 질문 생성 속도 (3-5초 이내)
- [ ] 질문의 관련성 및 구체성
- [ ] 완료 질문까지의 질문 수 (보통 5-10개)

### 2. 프로젝트 이름 추천 기능 테스트

**목적**: 프로젝트 이름 질문 시 Gemini가 추천하는 이름들이 표시되는지 확인

**테스트 절차**:
1. 채팅 플로우에서 프로젝트 이름 관련 질문이 나올 때까지 진행
2. 프로젝트 이름 추천 화면이 표시되는지 확인
3. 추천된 3개의 이름 확인
4. 이름 선택 또는 직접 입력
5. 다음 질문으로 진행되는지 확인

**예상 결과**:
- ✅ 프로젝트 이름 추천이 자동으로 표시됨
- ✅ 3개의 이름이 추천됨
- ✅ 각 이름에 설명이 포함됨
- ✅ 이름 선택 시 다음 질문으로 진행됨

**확인 사항**:
- [ ] 추천 이름의 적절성
- [ ] 로딩 시간 (2-3초 이내)
- [ ] "다음 추천 보기" 기능 동작

### 3. 문서 생성 기능 테스트

**목적**: 모든 질문 완료 후 문서가 정상적으로 생성되는지 확인

**테스트 절차**:
1. 모든 질문에 답변 완료
2. 완료 질문에 "예" 또는 "시작" 등으로 답변
3. 문서 생성 시작
4. 문서 프리뷰 화면 확인
5. 마크다운 형식 확인
6. 다운로드 기능 테스트 (선택사항)

**예상 결과**:
- ✅ 문서 생성이 시작됨
- ✅ 로딩 상태가 표시됨
- ✅ 문서가 마크다운 형식으로 생성됨
- ✅ 문서 내용이 질문/답변을 반영함
- ✅ 문서 프리뷰가 정상적으로 표시됨

**확인 사항**:
- [ ] 문서 생성 시간 (10-30초)
- [ ] 문서 구조 (개요, 환경 설정, 기능 명세서, 기술 요구사항 등)
- [ ] 문서 내용의 완성도

### 4. 에러 처리 테스트

**목적**: 에러 발생 시 사용자 친화적 메시지와 재시도 옵션이 제공되는지 확인

**테스트 시나리오**:
1. **API 키 누락 시**: GEMINI_API_KEY를 제거하고 테스트
   - 예상: "AI 서비스에 연결할 수 없습니다" 메시지
2. **네트워크 에러 시**: 네트워크 연결 끊기
   - 예상: "네트워크 연결에 문제가 있습니다" 메시지
3. **재시도 기능**: 에러 발생 시 재시도 옵션 제공
   - 예상: 확인 다이얼로그에서 재시도 선택 가능

**확인 사항**:
- [ ] 에러 메시지가 사용자 친화적임
- [ ] 재시도 옵션이 제공됨
- [ ] 에러 발생 시 앱이 크래시하지 않음

## 테스트 체크리스트

### 기본 기능
- [ ] 채팅 질문/답변 플로우
- [ ] 프로젝트 이름 추천
- [ ] 문서 생성
- [ ] 에러 처리

### UI/UX
- [ ] 로딩 상태 표시
- [ ] 메시지 버블 스타일
- [ ] 반응형 디자인
- [ ] 사이드바 기능

### 성능
- [ ] 질문 생성 속도
- [ ] 문서 생성 속도
- [ ] 페이지 로딩 속도

## 문제 해결

### 채팅이 작동하지 않는 경우

1. **GEMINI_API_KEY 확인**
   ```bash
   fly secrets list --app prompt-booster
   ```

2. **앱 로그 확인**
   ```bash
   fly logs --app prompt-booster
   ```

3. **앱 재시작**
   ```bash
   fly apps restart prompt-booster
   ```

### 문서 생성이 실패하는 경우

1. **데이터베이스 연결 확인**
   ```bash
   fly postgres connect -a prompt-booster-db
   ```

2. **마이그레이션 상태 확인**
   ```bash
   fly ssh console -a prompt-booster
   prisma migrate status
   ```

## 참고

- 테스트는 GEMINI_API_KEY가 설정된 후에만 가능합니다
- 자세한 설정 가이드는 [GEMINI_API_KEY_SETUP.md](./GEMINI_API_KEY_SETUP.md) 참조
- 전체 설정 체크리스트는 [CHAT_SETUP_CHECKLIST.md](./CHAT_SETUP_CHECKLIST.md) 참조

